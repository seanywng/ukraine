"0","bigrams <- rw %>% "
"0","  # You're filtering out one clump here "
"0","  # filter(source %out% c(""IAEA"", ""ACLED"")) %>% "
"0","  select(source, id, body) %>% "
"0","  unnest_tokens(bigram, body, token = ""ngrams"", n = 2) %>% "
"0","  filter(!is.na(bigram)) %>% "
"0","  separate(bigram, c(""word1"", ""word2""), sep = "" "") %>% "
"0","  mutate(word = str_remove_all(word1, "" \\'s""), "
"0","         word2 = str_remove_all(word2, ""\\'s"")) %>%"
"0","  filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>% "
"0","  filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>% "
"0","  filter(str_detect(word1, ""[a-z]"") & !str_detect(word1, ""<"")) %>% "
"0","  filter(str_detect(word2, ""[a-z]"") & !str_detect(word2, ""<"")) %>% "
"0","  filter(!str_detect(word1, ""\\.(com|org|edu|gov)"") & "
"0","           !str_detect(word2, ""\\.(com|org|edu|gov)"")) %>% "
"0","  unite(bigram, word1, word2, sep = "" "")"
"0",""
"0","tf_idf_bigrams_odds <- bigrams %>% "
"0","  count(source, bigram) %>% "
"0","  bind_tf_idf(bigram, source, n) %>% "
"0","  bind_log_odds(bigram, source, n) %>% "
"0","  arrange(desc(tf_idf)) %>% "
"0","  rename(word = bigram) %>% "
"0","  add_count(word, wt = n, name = ""word_total"") %>% "
"0","  group_by(source) %>% "
"0","  mutate(max_log_odds_weighted = "
"0","           max(log_odds_weighted[!is.infinite(log_odds_weighted)], na.rm = TRUE)) %>% "
"0","  mutate(log_odds_weighted = ifelse(is.infinite(log_odds_weighted), "
"0","                                    max(max_log_odds_weighted), "
"0","                                    log_odds_weighted)) %>% "
"0","  ungroup() %>% "
"0","  filter(n > 1) %>% "
"0","  left_join(bigrams %>% select(source, word = bigram, id), "
"0","            by = c(""source"" = ""source"", ""word"" = ""word""))"
