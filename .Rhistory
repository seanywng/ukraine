separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 20) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
# Try again with the excluded sources
ukr %>%
filter(source %out% c("IAEA", "ACLED", "OSCE")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 20) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
# Try again with the excluded sources
ukr %>%
filter(source %out% c("IAEA", "ACLED", "OSCE")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 15) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
# Try again with the excluded sources
ukr %>%
filter(source %out% c("IAEA", "ACLED", "OSCE")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
ukr %>%
filter(source %out% c("IAEA", "ACLED", "OSCE")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
rw <- read_csv("./data/scraped_full_20230101_20220101.csv") %>%
mutate(date = dmy(date),
month = month(date)) %>%
left_join(ukr_links, by = c("link" = "url")) %>%
filter(link %out% to_remove)
rw %>%
filter(source %out% c("IAEA", "ACLED", "OSCE")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 20) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
rw %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
rw %>%
count(source, type, sort = TRUE)
rw %>%
count(source, sort = TRUE)
rw %>%
count(type, sort = TRUE)
hum <- read_csv("./data/scraped_full_20230101_20220101.csv") %>%
mutate(date = dmy(date),
month = month(date)) %>%
left_join(ukr_links, by = c("link" = "url")) %>%
filter(link %out% to_remove) %>%
filter(type %out% c("News and Press Release"))
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(log_odds_weighted), desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = log_odds_weighted,
y = fct_reorder(word, log_odds_weighted),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(tf_idf), desc(log_odds_weighted)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = tf_idf,
y = fct_reorder(word, tf_idf),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
?fct_reorder
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(tf_idf), desc(log_odds_weighted)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = tf_idf,
y = fct_reorder(word, tf_idf, .fun = sum),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(tf_idf), desc(log_odds_weighted)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = tf_idf,
y = fct_reorder(word, tf_idf, .fun = mean),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(tf_idf), desc(log_odds_weighted)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup()
rw %>%
filter(type %in% c("News and Press Release")) %>%
select(id, month, body) %>%
unnest_tokens(bigram, body, token = "ngrams", n = 2) %>%
filter(!is.na(bigram)) %>%
separate(bigram, c("word1", "word2"), sep = " ") %>%
filter(!word1 %in% stop_words$word & (nchar(word1) < 20)) %>%
filter(!word2 %in% stop_words$word & (nchar(word2) < 20)) %>%
filter(str_detect(word1, "[a-z]") & !str_detect(word1, "<")) %>%
filter(str_detect(word2, "[a-z]") & !str_detect(word2, "<")) %>%
unite(bigram, word1, word2, sep = " ") %>%
count(month, bigram) %>%
bind_tf_idf(bigram, month, n) %>%
bind_log_odds(bigram, month, n) %>%
arrange(desc(tf_idf)) %>%
filter(bigram %out% c("million people", "humanitarian assistance")) %>%
rename(word = bigram) %>%
filter(n > 1) %>%
ungroup() %>%
filter(!is.infinite(log_odds_weighted)) %>%
mutate(month = factor(month.abb[month],levels = month.abb)) %>%
group_by(month) %>%
arrange(desc(tf_idf)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 16) %>%
ungroup() %>%
ggplot(aes(x = tf_idf,
y = fct_reorder(word, tf_idf),
fill = month)) +
geom_col(show.legend = FALSE) +
scale_fill_viridis_d() +
facet_wrap(~ month, scales = "free") +
labs(x = "Log-odds",
y = "",
title = "Reliefweb Ukraine articles: log-odds of word specificity by month",
subtitle = "A year of humanitarian rhetoric") +
theme(legend.position = "none",
axis.text.x = element_text(size = 5, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 9, face = "bold"),
strip.background = element_rect(fill = "#212121"))
library(here)
